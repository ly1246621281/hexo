---
categories:
  - JAVA总结
  - JAVA（2020--2023）
---
# 事务

# 通过propagation属性配置事务的传播行为

事务的传播行为，默认值为 Propagation.REQUIRED。可以手动指定其他的事务传播行为，如下：

- Propagation.REQUIRED

如果当前存在事务，则加入该事务，如果当前不存在事务，则创建一个新的事务。

- Propagation.SUPPORTS

如果当前存在事务，则加入该事务；如果当前不存在事务，则以非事务的方式继续运行。

- Propagation.MANDATORY

如果当前存在事务，则加入该事务；如果当前不存在事务，则抛出异常。

---

- Propagation.REQUIRES_NEW

重新创建一个新的事务，如果当前存在事务，挂起当前的事务。

- Propagation.NOT_SUPPORTED

以非事务的方式运行，如果当前存在事务，挂起当前的事务。

NOT_SUPPORTED（当前方法不应该有事务，如果有事务存在，将它挂起，以无事务状态运行）可以看到将当前事务挂起，在无事务状态运行，并且在ServiceB方法中做的数据库操作不会随着全局事务回退而回退；

- Propagation.NEVER

以非事务的方式运行，如果当前存在事务，则抛出异常。

- Propagation.NESTED

如果没有，就新建一个事务；如果有，就在当前事务中嵌套其他事务。

# 通过isolation 属性配置事务的隔离级别

事务的隔离级别，默认值为 Isolation.DEFAULT，这个跟数据库的隔离级别有关系。可以自定义隔离级别，如下：

- Isolation.DEFAULT
- Isolation.READ_UNCOMMITTED
- Isolation.READ_COMMITTED
- Isolation.REPEATABLE_READ
- Isolation.SERIALIZABLE

**事务的传播行为和隔离级别是比较抽象的东西，本文作为springboot的教程课程暂且不做探讨，等后续有时间会再写文章做探讨。**

# timeout 属性

事务的超时时间，默认值为-1。如果设置了该时间，超过该时间限制但事务还没有完成，则自动回滚事务。



[demo实例](https://blog.csdn.net/weixin_39976081/article/details/115074721?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522164126728516780261916557%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fblog.%2522%257D&request_id=164126728516780261916557&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_ecpm_v1~rank_v31_ecpm-2-115074721.nonecase&utm_term=java+%E4%BA%8B%E7%89%A9+notsupport&spm=1018.2226.3001.4450)



# Transactional注解通过noRollbackFor配置不回滚的异常

Transactional注解可以配置发生某个异常时不进行回滚。比如我在Transaction注解上添加如下属性，指定ArithmeticException不进行事务的回滚。

```java
@Transactional(noRollbackFor = ArithmeticException.class)
```