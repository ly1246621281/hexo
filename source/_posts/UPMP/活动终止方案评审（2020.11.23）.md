---
categories:
  - UPMP
---
# 活动终止方案评审（2020.11.23）

## 1.终止活动

### 1.1前端工作

* 前端校验用户角色类型

* 前端提供活动状态置灰与选择
* 前端增加终止活动弹框
* 关联改动中 前端新增活动状态：“已终止”
* 关联改动中 前端修改活动进度增加“已终止”节点

### 1.2后端工作

* 后端校验用户角色类型

* 后端判断活动状态是否可进行活动终止

* 后端提供活动终止接口（释放库存、停止派发，记录终止操作的操作人和操作时间）

  > 1.修改活动状态，并写入审计表中。
  >
  > 2.使用CompleteActivityJob，每分钟一次，若活动状态为终止同时是试用品or话卡活动，去释放库存。

### 1.3 需修改前后端接口项

* 前后端增加活动状态--31为已终止
* 前后端活动实体类增加字段 “preStatus” :前置状态位

>  **"preStatus"** : 30, // 整型, 活动状态, (值含义: -1：未知状态，1:草稿, 2:采销审核中, 3:平台运营审核中, 4. 驳回, 5:已创建, 6:开启中, 7:开启失败, 8:待开始, 9:活动中, 10:暂停, 30:已完成，31:已终止)；
>
>  若是已完成之后终止，则为30，其他前置活动状态的终止都是在已完成前终止。注：若是找不到前置活动状态，-1为未知状态；

