---
categories:
  - UPMP
---
# [专仓活动校验库存](https://cf.jd.com/pages/viewpage.action?pageId=521871097)

# 1.需求范围

> 1. 专仓活动
> 2. 开启状态  和  调整库存

# 2. 技术方案

> 1.action/activity/getWarehouseDist
>
> 增加专仓逻辑判断：计算专仓可用库存量，库存列表展示
>
> 2.action/activity/startActivityWithWarehouseDistById
>
> ```
> action/activity/configWarehouseDistById
> ```
>
> 调整专仓库存：
>
> * 库存量计算 **库存量**=min{可用库存；渠道可用库存}+该活动已匹配量-同一sku其他专仓活动剩余派发量之和；（当库存量＜已匹配量时，库存量=已匹配量）
> * 库存量＜已匹配量时，调整失败，返回 “仓库物品不足(计划派发量＞库存量)，活动调整库存失败”
>
> 3.若首次开启活动时，若挖包失败或者其他原因，需移除Warehouse_dist表里此库存记录。
>
> 4.若非首次开启或者调整库存，失败后应维持第一次调整库存前的库存量。

![image-20210720105902396](https://raw.githubusercontent.com/ly1246621281/PicGo/main/imgimage-20210720105902396.png)