---
categories:
  - UPMP
---
# 一试爱上3.5 看板相关

## 1.仓库模式

新增仓库模式字段 warehouse_type (仓库模式,0为同仓，1为专仓，-1待定)   **tinyint**

涉及表： board_activity   board_activity_pin

位置在：distribution_model 之后

## 2. 复购用户数

新增deal_target_sku_count（目标商品成交次数）  deal_target_brand_count（目标品牌成交次数） **smallint**

涉及表： board_activity_pin

位置在：user_type之后,先deal_target_sku_count，后deal_target_brand_count



## 3.搜索且点击

1.是否搜索且点击目标商品 is_search_target_sku （0为未操作，1为操作） **tinyint**

2.是否搜索且点击目标品牌 is_search_target_brand （0为未操作，1为操作） **tinyint**

3.**待定** search_target_sku_count. **smallint**

4.**待定**search_target_brand_count **smallint**

涉及表： board_activity_pin

位置在：deal_target_brand_count之后

若3,4添加，則在board_activity_summary表中增加  (search_target_sku_count,search_target_brand_count ) dt之前



## 4.专仓触达新用户数

1. `reach_target_brand_new` smallint unsigned  default 0 comment '专仓触达品牌新用户数',
    `reach_target_brand_old` smallint unsigned  default 0 comment '专仓触达品牌老用户数',

```sql
    -- board_activity
        alter table board_activity add column warehouse_type tinyint DEFAULT 0 NOT NULL COMMENT '仓库模式,0为同仓，1为专仓，-1待定' after distribution_model;
        alter table board_activity_pin add column warehouse_type tinyint DEFAULT 0 NOT NULL COMMENT '仓库模式,0为同仓，1为专仓，-1待定' after distribution_model;
     -- board_activity_pin   
        alter table board_activity_pin add column deal_target_sku_count SMALLINT UNSIGNED DEFAULT 0 NOT NULL COMMENT '目标商品成交次数，用于计算复购用户数' after user_type;
        alter table board_activity_pin add column deal_target_brand_count SMALLINT UNSIGNED DEFAULT 0 NOT NULL COMMENT '目标品牌成交次数，用于计算复购用户数' after deal_target_sku_count;
         
        alter table board_activity_pin add column is_search_target_sku tinyint UNSIGNED DEFAULT 0 NOT NULL COMMENT '是否搜索且点击目标商品 0为否1为是' after deal_target_brand_count;
       alter table board_activity_pin add column is_search_target_brand tinyint UNSIGNED DEFAULT 0 NOT NULL COMMENT '是否搜索且点击目标品牌 0为否1为是' after is_search_target_sku;
       
        alter table board_activity_pin add column search_target_sku_count  SMALLINT UNSIGNED DEFAULT 0 NOT NULL COMMENT '目标商品搜索且点击次数' after is_search_target_brand;
        alter table board_activity_pin add column search_target_brand_count  SMALLINT UNSIGNED DEFAULT 0 NOT NULL COMMENT '目标品牌搜索且点击次数' after search_target_sku_count;
       -- board_activity_summary（Summary暂不执行，前期和数据侧未及时沟通）
          alter table board_activity_summary add column search_target_sku_count  SMALLINT UNSIGNED DEFAULT 0 NOT NULL COMMENT '目标商品搜索且点击次数' after target_brand_amount_old; 
        alter table board_activity_summary add column search_target_brand_count  SMALLINT UNSIGNED DEFAULT 0 NOT NULL COMMENT '目标品牌搜索且点击次数' after search_target_sku_count; 
       
        
```



```sql
    create table board_special_warehouse_stat
      (
       `id` bigint NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `activity_dt` date DEFAULT NULL COMMENT '日期',
  `activity_id` int(11) DEFAULT NULL COMMENT '活动id',
  `activity_name` varchar(50) DEFAULT NULL COMMENT '活动名称',
  `reach_target_brand_new` smallint unsigned  default 0 comment '专仓触达品牌新用户数',
  `reach_target_brand_old` smallint unsigned  default 0 comment '专仓触达品牌老用户数',
  `dt` varchar(50) DEFAULT NULL COMMENT 'dt',
  PRIMARY KEY (`id`),
  KEY `idx_id_dt` (`activity_id`,`activity_dt`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COMMENT='运营看板-专仓活动相关统计信息'
```

push表增加deleted字段

```sql
alter table board_push_data_finish  add column deleted tinyint(4) default 0 comment '删除标识,0为否,1为是'
```



// 2021.11.29 加索引

```sql
alter table board_activity_pin add index idx_search_brand(is_search_target_brand,activity_id,activity_dt,user_log_acct), add index idx_search_sku(is_search_target_sku,activity_id,activity_dt,user_log_acct), add index idx_repurchaseCount_brand(is_deal_target_brand,activity_id,activity_dt,user_log_acct,deal_target_brand_count), add index idx_repurchaseCount_sku(is_deal_target_sku,activity_id,activity_dt,user_log_acct,deal_target_sku_count)
```

